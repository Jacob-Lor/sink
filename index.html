<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build Your Portfolio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #e1e9ff 0%, #9faddd 25%, #92b4ff 50%, #e3eeff 100%);
            min-height: 100vh;
            color: #1f2937;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            padding: 32px 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 12px;
            font-weight: 700;
            letter-spacing: -0.02em;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            font-weight: 400;
        }

        .game-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 28px 24px;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.08);
            text-align: center;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
            position: relative;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #1e40af, #3b82f6);
            border-radius: 12px 12px 0 0;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
        }

        .stat-card h3 {
            color: #4b5563;
            margin-bottom: 12px;
            font-size: 0.95em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: 700;
            color: #1f2937;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
        }

        .news-section {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            padding: 24px 28px;
            border-radius: 12px;
            margin-bottom: 32px;
            box-shadow: 0 4px 20px rgba(5, 150, 105, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .news-section h3 {
            margin-bottom: 12px;
            font-size: 1.3em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .news-section p {
            font-size: 1.05em;
            line-height: 1.5;
            font-weight: 400;
        }

        .debt-section, .investment-section {
            background: white;
            padding: 36px 32px;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.08);
            margin-bottom: 32px;
            border: 1px solid #e5e7eb;
        }

        .debt-section h2, .investment-section h2 {
            color: #1f2937;
            margin-bottom: 28px;
            font-size: 1.8em;
            font-weight: 700;
            padding-bottom: 12px;
            border-bottom: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .debt-section h2 {
            color: #dc2626;
            border-bottom-color: #fecaca;
        }

        .debt-options, .investment-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
        }

        .investment-card {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
            background: #fafafa;
            position: relative;
            overflow: hidden;
        }

        .investment-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #6366f1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .investment-card:hover::before {
            opacity: 1;
        }

        .investment-card:hover {
            border-color: #3b82f6;
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(59, 130, 246, 0.15);
            background: white;
        }

        .investment-card.debt-card {
            border: 2px solid #fca5a5;
            background: #fef2f2;
        }

        .investment-card.debt-card::before {
            background: linear-gradient(90deg, #dc2626, #ef4444);
        }

        .investment-card.debt-card:hover {
            border-color: #dc2626;
            box-shadow: 0 12px 40px rgba(220, 38, 38, 0.15);
            background: #fefefe;
        }

        .investment-card h4 {
            color: #1f2937;
            margin-bottom: 12px;
            font-size: 1.25em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .debt-card h4 {
            color: #dc2626;
        }

        .investment-card p {
            margin-bottom: 20px;
            color: #6b7280;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .price-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 16px;
            background: rgba(59, 130, 246, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.1);
        }

        .debt-card .price-info {
            background: rgba(220, 38, 38, 0.05);
            border-color: rgba(220, 38, 38, 0.1);
        }

        .current-price {
            font-weight: 700;
            color: #1f2937;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 1.1em;
        }

        .price-change {
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
        }

        .price-up {
            color: #059669;
            background: rgba(5, 150, 105, 0.1);
            border: 1px solid rgba(5, 150, 105, 0.2);
        }

        .price-down {
            color: #dc2626;
            background: rgba(220, 38, 38, 0.1);
            border: 1px solid rgba(220, 38, 38, 0.2);
        }

        .investment-controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .amount-input {
            flex: 1;
            padding: 14px 16px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 16px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            transition: all 0.3s ease;
            background: white;
        }

        .amount-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .invest-btn {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            transition: all 0.3s ease;
            min-width: 120px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .invest-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(30, 64, 175, 0.3);
            background: linear-gradient(135deg, #1e3a8a, #2563eb);
        }

        .invest-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .debt-btn {
            background: linear-gradient(135deg, #dc2626, #ef4444);
        }

        .debt-btn:hover {
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.3);
            background: linear-gradient(135deg, #b91c1c, #dc2626);
        }

        .portfolio-section {
            background: white;
            padding: 36px 32px;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.08);
            margin-bottom: 32px;
            border: 1px solid #e5e7eb;
        }

        .portfolio-section h2 {
            color: #1f2937;
            margin-bottom: 28px;
            font-size: 1.8em;
            font-weight: 700;
            padding-bottom: 12px;
            border-bottom: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .portfolio-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid #f3f4f6;
            transition: all 0.3s ease;
        }

        .portfolio-item:hover {
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.02), transparent);
            padding-left: 12px;
            padding-right: 12px;
            border-radius: 8px;
        }

        .portfolio-item:last-child {
            border-bottom: none;
        }

        .portfolio-item strong {
            font-weight: 600;
            color: #1f2937;
        }

        .portfolio-item small {
            color: #6b7280;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
        }

        .debt-item {
            background: linear-gradient(90deg, rgba(220, 38, 38, 0.02), rgba(220, 38, 38, 0.05), rgba(220, 38, 38, 0.02));
            border: 1px solid rgba(220, 38, 38, 0.1);
            border-radius: 8px;
            padding: 20px;
            margin: 8px 0;
        }

        .controls {
            text-align: center;
            margin-bottom: 40px;
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .next-period-btn {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 160px;
        }

        .next-period-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(5, 150, 105, 0.3);
            background: linear-gradient(135deg, #047857, #059669);
        }

        .reset-btn {
            background: linear-gradient(135deg, #6b7280, #9ca3af);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 160px;
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(107, 114, 128, 0.3);
            background: linear-gradient(135deg, #4b5563, #6b7280);
        }

        .game-over {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 48px 40px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 20px 64px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .game-over h2 {
            font-size: 2.8em;
            margin-bottom: 24px;
            font-weight: 700;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .final-score {
            font-size: 3.5em;
            font-weight: 800;
            margin: 24px 0;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            letter-spacing: -0.02em;
        }

        .game-over p {
            font-size: 1.2em;
            margin-bottom: 24px;
            opacity: 0.9;
        }

        /* Professional banking-style enhancements */
        .stat-card:nth-child(1) .stat-value { color: #059669; }
        .stat-card:nth-child(2) .stat-value { color: #3b82f6; }
        .stat-card:nth-child(3) .stat-value { color: #7c3aed; }
        .stat-card:nth-child(4) .stat-value { color: #f59e0b; }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .debt-options, .investment-options {
                grid-template-columns: 1fr;
            }
            
            .investment-controls {
                flex-direction: column;
                gap: 12px;
            }
            
            .amount-input {
                width: 100%;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .next-period-btn, .reset-btn {
                width: 100%;
                max-width: 280px;
            }
            
            .debt-section, .investment-section, .portfolio-section {
                padding: 24px 20px;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 24px 16px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .final-score {
                font-size: 2.5em;
            }
            
            .game-over {
                padding: 32px 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📈 Build Your Portfolio</h1>
            <p>Make smart investment decisions over 30 months and watch your money grow!</p>
        </div>

        <div class="game-stats">
            <div class="stat-card">
                <h3>💰 Available Cash</h3>
                <div class="stat-value" id="cash">$5,000</div>
            </div>
            <div class="stat-card">
                <h3>📊 Portfolio Value</h3>
                <div class="stat-value" id="portfolioValue">$0</div>
            </div>
            <div class="stat-card">
                <h3>💎 Total Worth</h3>
                <div class="stat-value" id="totalWorth">$5,000</div>
            </div>
            <div class="stat-card">
                <h3>📅 Month</h3>
                <div class="stat-value" id="period">1 / 30</div>
            </div>
        </div>

        <div class="news-section" id="newsSection">
            <h3>📰 Market News</h3>
            <p id="newsText">Welcome to the investment game! You start with $5,000. Make wise choices!</p>
        </div>

        <div class="debt-section" id="debtSection">
            <h2>💳 Debt Options</h2>
            <div class="debt-options" id="debtOptions">
                <!-- Debt cards will be generated here -->
            </div>
        </div>

        <div class="investment-section" id="investmentSection" style="display: none;">
            <h2>💼 Investment Options</h2>
            <div class="investment-options" id="investmentOptions">
                <!-- Investment cards will be generated here -->
            </div>
        </div>

        <div class="portfolio-section">
            <h2>📋 Your Portfolio</h2>
            <div id="portfolio">
                <p style="text-align: center; color: #666; padding: 20px;">No investments yet. Start building your portfolio!</p>
            </div>
        </div>

        <div class="controls">
            <button class="next-period-btn" id="nextPeriodBtn">⏭️ Next Month</button>
            <button class="reset-btn" id="resetBtn">🔄 Reset Game</button>
        </div>

        <div class="game-over" id="gameOver" style="display: none;">
            <h2>🎉 Game Complete!</h2>
            <div class="final-score" id="finalScore">$0</div>
            <p>You've completed 30 months of investing!</p>
            <button class="reset-btn" onclick="resetGame()" style="margin-top: 20px;">Play Again</button>
        </div>
    </div>

    <script>
        // Game state
        let gameState = {
            cash: 5000,
            period: 1,
            maxPeriods: 30,
            portfolio: {},
            investments: {
                stocks: { 
                    name: 'Stock Market Index', 
                    price: 100, 
                    basePrice: 100,
                    description: 'Diversified stock market fund with moderate risk and good long-term returns',
                    volatility: 0.15 
                },
                bonds: { 
                    name: 'Government Bonds', 
                    price: 100, 
                    basePrice: 100,
                    description: 'Safe government bonds with steady, low returns',
                    volatility: 0.05 
                },
                creditcard: { 
                    name: 'Credit Card Debt', 
                    price: 8500, 
                    basePrice: 8500,
                    description: 'Pay off high-interest credit card debt (1.5% monthly interest) - guaranteed return!',
                    volatility: 0.0,
                    isDebt: true,
                    monthlyInterestRate: 0.015
                },
                payday: { 
                    name: 'Payday Loan Debt', 
                    price: 1200, 
                    basePrice: 1200,
                    description: 'Pay off extremely high-interest payday loans (33.3% monthly interest) - urgent priority!',
                    volatility: 0.0,
                    isDebt: true,
                    monthlyInterestRate: 0.333
                },
                autoloan: { 
                    name: 'Auto Loan Debt', 
                    price: 15000, 
                    basePrice: 15000,
                    description: 'Pay off car loan debt (0.5% monthly interest) - moderate interest rate',
                    volatility: 0.0,
                    isDebt: true,
                    monthlyInterestRate: 0.005
                },
                mortgage: { 
                    name: 'Mortgage Debt', 
                    price: 45000, 
                    basePrice: 45000,
                    description: 'Pay extra on mortgage (0.33% monthly interest) - low interest, but guaranteed return',
                    volatility: 0.0,
                    isDebt: true,
                    monthlyInterestRate: 0.0033
                }
            },
            priceHistory: {},
            newsEvents: [
                "Market showing steady growth across all sectors.",
                "Economic indicators suggest continued expansion.",
                "Tech sector experiencing significant growth this month.",
                "Interest rates remain stable, benefiting bond markets.",
                "Financial advisors recommend paying off high-interest debt first.",
                "Credit card interest rates continue to climb nationwide.",
                "Auto loan rates see slight increase due to Federal Reserve policy.",
                "Mortgage rates remain competitive for qualified borrowers.",
                "Consumer debt reaches new highs - experts advise caution.",
                "Payday loan regulations tighten in several states.",
                "Real estate market shows strong fundamentals.",
                "Global markets react to positive economic data.",
                "Debt consolidation services see increased demand.",
                "Financial literacy programs emphasize debt management."
            ]
        };

        // Initialize price history
        Object.keys(gameState.investments).forEach(key => {
            gameState.priceHistory[key] = [gameState.investments[key].price];
        });

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function updatePrices() {
            Object.keys(gameState.investments).forEach(key => {
                const investment = gameState.investments[key];
                if (investment.isDebt) {
                    // Debt grows with monthly interest
                    investment.price = Math.round(investment.price * (1 + investment.monthlyInterestRate));
                } else {
                    // Regular investments fluctuate with market volatility
                    const change = (Math.random() - 0.5) * 2 * investment.volatility;
                    const newPrice = Math.max(investment.price * (1 + change), 10);
                    investment.price = Math.round(newPrice);
                }
                gameState.priceHistory[key].push(investment.price);
            });
        }

        function calculatePortfolioValue() {
            let totalValue = 0;
            Object.keys(gameState.portfolio).forEach(key => {
                if (gameState.portfolio[key] > 0) {
                    totalValue += gameState.portfolio[key] * gameState.investments[key].price;
                }
            });
            return totalValue;
        }

        function calculateTotalDebt() {
            let totalDebt = 0;
            Object.keys(gameState.investments).forEach(key => {
                const investment = gameState.investments[key];
                if (investment.isDebt && investment.price > 0) {
                    totalDebt += investment.price;
                }
            });
            return totalDebt;
        }

        function updateDisplay() {
            document.getElementById('cash').textContent = formatCurrency(gameState.cash);
            document.getElementById('period').textContent = `${gameState.period} / ${gameState.maxPeriods}`;
            
            const portfolioValue = calculatePortfolioValue();
            const totalDebt = calculateTotalDebt();
            const netWorth = gameState.cash + portfolioValue - totalDebt;
            
            document.getElementById('portfolioValue').textContent = formatCurrency(portfolioValue);
            document.getElementById('totalWorth').textContent = formatCurrency(netWorth);

            // Show/hide investment options based on round
            const investmentSection = document.getElementById('investmentSection');
            if (gameState.period >= 5) {
                investmentSection.style.display = 'block';
                updateInvestmentOptions();
            } else {
                investmentSection.style.display = 'none';
            }

            // Update debt options
            updateDebtOptions();

            updatePortfolioDisplay();
        }

        function updateDebtOptions() {
            const debtOptions = document.getElementById('debtOptions');
            debtOptions.innerHTML = '';

            Object.keys(gameState.investments).forEach(key => {
                const investment = gameState.investments[key];
                if (!investment.isDebt) return;

                const priceHistory = gameState.priceHistory[key];
                const priceChange = priceHistory.length > 1 ? 
                    investment.price - priceHistory[priceHistory.length - 2] : 0;
                const priceChangePercent = priceHistory.length > 1 ? 
                    ((priceChange / priceHistory[priceHistory.length - 2]) * 100).toFixed(1) : 0;

                const card = document.createElement('div');
                card.className = 'investment-card debt-card';
                
                card.innerHTML = `
                    <h4>💳 ${investment.name}</h4>
                    <p>${investment.description}</p>
                    <div class="price-info">
                        <span class="current-price">Debt Balance: ${formatCurrency(investment.price)}</span>
                        <span class="price-change ${priceChange >= 0 ? 'price-up' : 'price-down'}">
                            ${priceChange >= 0 ? '+' : ''}${formatCurrency(priceChange)} (${priceChangePercent}%)
                        </span>
                    </div>
                    <div class="investment-controls">
                        <input type="number" class="amount-input" placeholder="Amount to pay off" min="1" max="${gameState.cash}" id="amount-${key}">
                        <button class="invest-btn debt-btn" onclick="makeInvestment('${key}')" ${gameState.cash <= 0 ? 'disabled' : ''}>
                            Pay Off
                        </button>
                    </div>
                `;
                debtOptions.appendChild(card);
            });
        }

        function updateInvestmentOptions() {
            const investmentOptions = document.getElementById('investmentOptions');
            investmentOptions.innerHTML = '';

            Object.keys(gameState.investments).forEach(key => {
                const investment = gameState.investments[key];
                if (investment.isDebt) return;

                const priceHistory = gameState.priceHistory[key];
                const priceChange = priceHistory.length > 1 ? 
                    investment.price - priceHistory[priceHistory.length - 2] : 0;
                const priceChangePercent = priceHistory.length > 1 ? 
                    ((priceChange / priceHistory[priceHistory.length - 2]) * 100).toFixed(1) : 0;

                const card = document.createElement('div');
                card.className = 'investment-card';
                
                card.innerHTML = `
                    <h4>${investment.name}</h4>
                    <p>${investment.description}</p>
                    <div class="price-info">
                        <span class="current-price">${formatCurrency(investment.price)}</span>
                        <span class="price-change ${priceChange >= 0 ? 'price-up' : 'price-down'}">
                            ${priceChange >= 0 ? '+' : ''}${formatCurrency(priceChange)} (${priceChangePercent}%)
                        </span>
                    </div>
                    <div class="investment-controls">
                        <input type="number" class="amount-input" placeholder="Amount to invest" min="1" max="${gameState.cash}" id="amount-${key}">
                        <button class="invest-btn" onclick="makeInvestment('${key}')" ${gameState.cash <= 0 ? 'disabled' : ''}>
                            Invest
                        </button>
                    </div>
                `;
                investmentOptions.appendChild(card);
            });
        }

        function updatePortfolioDisplay() {
            const portfolioDiv = document.getElementById('portfolio');
            portfolioDiv.innerHTML = '';

            let hasInvestments = false;
            let hasDebts = false;

            // Show regular investments
            Object.keys(gameState.portfolio).forEach(key => {
                if (gameState.portfolio[key] > 0) {
                    hasInvestments = true;
                    const investment = gameState.investments[key];
                    const value = gameState.portfolio[key] * investment.price;
                    const item = document.createElement('div');
                    item.className = 'portfolio-item';
                    item.innerHTML = `
                        <div>
                            <strong>${investment.name}</strong><br>
                            <small>${gameState.portfolio[key]} shares @ ${formatCurrency(investment.price)}</small>
                        </div>
                        <div style="text-align: right;">
                            <strong>${formatCurrency(value)}</strong>
                        </div>
                    `;
                    portfolioDiv.appendChild(item);
                }
            });

            // Show remaining debts
            Object.keys(gameState.investments).forEach(key => {
                const investment = gameState.investments[key];
                if (investment.isDebt && investment.price > 0) {
                    hasDebts = true;
                    const item = document.createElement('div');
                    item.className = 'portfolio-item debt-item';
                    item.innerHTML = `
                        <div>
                            <strong>💳 ${investment.name}</strong><br>
                            <small>Remaining debt balance (${(investment.monthlyInterestRate * 100).toFixed(2)}% monthly interest)</small>
                        </div>
                        <div style="text-align: right; color: #ef4444;">
                            <strong>-${formatCurrency(investment.price)}</strong>
                        </div>
                    `;
                    portfolioDiv.appendChild(item);
                }
            });

            if (!hasInvestments && !hasDebts) {
                portfolioDiv.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No investments yet and no debts remaining. Start building your portfolio!</p>';
            } else if (!hasInvestments && hasDebts) {
                portfolioDiv.innerHTML += '<p style="text-align: center; color: #ef4444; padding: 10px; font-weight: bold;">⚠️ Consider paying off high-interest debt before investing!</p>';
            }
        }

        function makeInvestment(investmentKey) {
            const amountInput = document.getElementById(`amount-${investmentKey}`);
            const amount = parseInt(amountInput.value);

            if (!amount || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }

            if (amount > gameState.cash) {
                alert('Insufficient funds!');
                return;
            }

            const investment = gameState.investments[investmentKey];
            
            if (investment.isDebt) {
                // Paying off debt - reduce debt balance
                const debtPayment = Math.min(amount, investment.price);
                investment.price -= debtPayment;
                gameState.cash -= debtPayment;
                
                if (investment.price <= 0) {
                    investment.price = 0;
                    alert(`Congratulations! You've paid off your ${investment.name}!`);
                }
            } else {
                // Regular investment - buy shares
                const shares = Math.floor(amount / investment.price);
                const totalCost = shares * investment.price;

                if (shares === 0) {
                    alert('Investment amount too small to purchase shares');
                    return;
                }

                gameState.cash -= totalCost;
                gameState.portfolio[investmentKey] = (gameState.portfolio[investmentKey] || 0) + shares;
            }

            amountInput.value = '';
            updateDisplay();
        }

        function nextPeriod() {
            if (gameState.period >= gameState.maxPeriods) {
                endGame();
                return;
            }

            gameState.period++;
            gameState.cash += 2000; // Add monthly income
            updatePrices();

            // Update news
            const randomNews = gameState.newsEvents[Math.floor(Math.random() * gameState.newsEvents.length)];
            document.getElementById('newsText').textContent = `Month ${gameState.period}: ${randomNews}`;

            updateDisplay();

            if (gameState.period >= gameState.maxPeriods) {
                document.getElementById('nextPeriodBtn').textContent = '🏁 Finish Game';
            }
        }

        function endGame() {
            const portfolioValue = calculatePortfolioValue();
            const totalDebt = calculateTotalDebt();
            const finalWorth = gameState.cash + portfolioValue - totalDebt;
            
            document.getElementById('finalScore').textContent = formatCurrency(finalWorth);
            document.getElementById('gameOver').style.display = 'block';
            document.getElementById('investmentSection').style.display = 'none';
            document.getElementById('debtSection').style.display = 'none';
            document.getElementById('nextPeriodBtn').style.display = 'none';
        }

        function resetGame() {
            gameState = {
                cash: 5000,
                period: 1,
                maxPeriods: 30,
                portfolio: {},
                investments: {
                    stocks: { 
                        name: 'Stock Market Index', 
                        price: 100, 
                        basePrice: 100,
                        description: 'Diversified stock market fund with moderate risk and good long-term returns',
                        volatility: 0.15 
                    },
                    bonds: { 
                        name: 'Government Bonds', 
                        price: 100, 
                        basePrice: 100,
                        description: 'Safe government bonds with steady, low returns',
                        volatility: 0.05 
                    },
                    creditcard: { 
                        name: 'Credit Card Debt', 
                        price: 8500, 
                        basePrice: 8500,
                        description: 'Pay off high-interest credit card debt (1.5% monthly interest) - guaranteed return!',
                        volatility: 0.0,
                        isDebt: true,
                        monthlyInterestRate: 0.015
                    },
                    payday: { 
                        name: 'Payday Loan Debt', 
                        price: 1200, 
                        basePrice: 1200,
                        description: 'Pay off extremely high-interest payday loans (33.3% monthly interest) - urgent priority!',
                        volatility: 0.0,
                        isDebt: true,
                        monthlyInterestRate: 0.333
                    },
                    autoloan: { 
                        name: 'Auto Loan Debt', 
                        price: 15000, 
                        basePrice: 15000,
                        description: 'Pay off car loan debt (0.5% monthly interest) - moderate interest rate',
                        volatility: 0.0,
                        isDebt: true,
                        monthlyInterestRate: 0.005
                    },
                    mortgage: { 
                        name: 'Mortgage Debt', 
                        price: 45000, 
                        basePrice: 45000,
                        description: 'Pay extra on mortgage (0.33% monthly interest) - low interest, but guaranteed return',
                        volatility: 0.0,
                        isDebt: true,
                        monthlyInterestRate: 0.0033
                    }
                },
                priceHistory: {},
                newsEvents: [
                    "Market showing steady growth across all sectors.",
                    "Economic indicators suggest continued expansion.",
                    "Tech sector experiencing significant growth this month.",
                    "Interest rates remain stable, benefiting bond markets.",
                    "Financial advisors recommend paying off high-interest debt first.",
                    "Credit card interest rates continue to climb nationwide.",
                    "Auto loan rates see slight increase due to Federal Reserve policy.",
                    "Mortgage rates remain competitive for qualified borrowers.",
                    "Consumer debt reaches new highs - experts advise caution.",
                    "Payday loan regulations tighten in several states.",
                    "Real estate market shows strong fundamentals.",
                    "Global markets react to positive economic data.",
                    "Debt consolidation services see increased demand.",
                    "Financial literacy programs emphasize debt management."
                ]
            };

            // Reinitialize price history
            Object.keys(gameState.investments).forEach(key => {
                gameState.priceHistory[key] = [gameState.investments[key].price];
            });

            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('investmentSection').style.display = 'none';
            document.getElementById('debtSection').style.display = 'block';
            document.getElementById('nextPeriodBtn').style.display = 'inline-block';
            document.getElementById('nextPeriodBtn').textContent = '⏭️ Next Month';
            document.getElementById('newsText').textContent = 'Welcome to the investment game! You start with $5,000. Make wise choices!';

            updateDisplay();
        }

        // Event listeners
        document.getElementById('nextPeriodBtn').addEventListener('click', nextPeriod);
        document.getElementById('resetBtn').addEventListener('click', resetGame);

        // Initialize game
        updateDisplay();
    </script>
</body>